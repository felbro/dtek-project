#include <stdint.h>   /* Declarations of uint_32 and the like */
const uint8_t const black[] = {
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
};

uint8_t firstSquare[] = {
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
};

uint8_t secondSquare[] = {
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
};
uint8_t thirdSquare[] = {
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
};
uint8_t fourthSquare[] = {
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
        255,255,255,255,255,255,255,255,
};



void drawCol(uint8_t col, uint8_t height) {
        char i;
        height /= 6;
        if(height >= 32) height = 31;

        if(col < 32) {
                for(i = 3; i >= 0; i--) {
                        firstSquare[i*32+col] = 0b11111111 >> height;
                        if(height >= 8) height -= 8;
                        else break;
                }
        }
        else if(col < 64) {
                col %= 32;
                for(i = 3; i >= 0; i--) {
                        secondSquare[i*32+col] = 0b11111111 >> height;
                        if(height >= 8) height -= 8;
                        else break;
                }
        }
        else if(col < 96) {
                col %= 64;
                for(i = 3; i >= 0; i--) {
                        thirdSquare[i*32+col] = 0b11111111 >> height;
                        if(height >= 8) height -= 8;
                        else break;
                }
        }
        else if(col < 128) {
                col %= 96;
                for(i = 3; i >= 0; i--) {
                        fourthSquare[i*32+col] = 0b11111111 >> height;
                        if(height >= 8) height -= 8;
                        else break;
                }
        }
}

void updateImages() {
        display_image(0,firstSquare);
        display_image(32,secondSquare);
        display_image(64,thirdSquare);
        display_image(96,fourthSquare);
}
void resetDisplay(){
        memcpy(firstSquare,black,128);
        memcpy(secondSquare,black,128);
        memcpy(thirdSquare,black,128);
        memcpy(fourthSquare,black,128);
}

void graph(int *arr) {
        resetDisplay();
        uint8_t i;
        for (i = 1; i < 128; i++) {
                drawCol(i,arr[i]);
        }
        updateImages();
}
